

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>skyllh.core.pdfratio module &mdash; SkyLLH  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="skyllh.core.progressbar module" href="skyllh.core.progressbar.html" />
    <link rel="prev" title="skyllh.core.pdf module" href="skyllh.core.pdf.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> SkyLLH
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../analysis/index.html">Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hypothesis/index.html">Hypothesis Definition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit_tests.html">Unit tests</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="skyllh.html">skyllh package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="skyllh.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="skyllh.cluster.html">skyllh.cluster package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="skyllh.core.html">skyllh.core package</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="skyllh.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="skyllh.core.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="skyllh.i3.html">skyllh.i3 package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyllh.physics.html">skyllh.physics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyllh.plotting.html">skyllh.plotting package</a></li>
<li class="toctree-l3"><a class="reference internal" href="skyllh.utils.html">skyllh.utils package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../notes.html">Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev_docs/logging.html">Logging</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SkyLLH</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="skyllh.html">skyllh package</a> &raquo;</li>
        
          <li><a href="skyllh.core.html">skyllh.core package</a> &raquo;</li>
        
      <li>skyllh.core.pdfratio module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/reference/skyllh.core.pdfratio.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-skyllh.core.pdfratio">
<span id="skyllh-core-pdfratio-module"></span><h1>skyllh.core.pdfratio module<a class="headerlink" href="#module-skyllh.core.pdfratio" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="skyllh.core.pdfratio.PDFRatio">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">PDFRatio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdf_type</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class for a PDF ratio class. It defines the interface
of a PDF ratio class.</p>
<p>Constructor for a PDF ratio class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pdf_type</strong> (<em>type</em>) – The Python type of the PDF object the PDF ratio is made for.</p>
</dd>
</dl>
<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.n_fitparams">
<em class="property">property </em><code class="sig-name descname">n_fitparams</code><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.n_fitparams" title="Permalink to this definition">¶</a></dt>
<dd><p>(read-only) The number of fit parameters the PDF ratio depends on.
This is the sum of signal and background fit parameters. At the moment
only signal fit parameters are supported, so this property is equivalent
to the n_signal_fitparams property. But this might change in the future.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.fitparam_names">
<em class="property">property </em><code class="sig-name descname">fitparam_names</code><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.fitparam_names" title="Permalink to this definition">¶</a></dt>
<dd><p>(read-only) The list of fit parameter names this PDF ratio is a
function of.
This is the superset of signal and background fit parameter names.
At the moment only signal fit parameters are supported, so this property
is equivalent to the signal_fitparam_names property. But this might
change in the future.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.n_signal_fitparams">
<em class="property">property </em><code class="sig-name descname">n_signal_fitparams</code><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.n_signal_fitparams" title="Permalink to this definition">¶</a></dt>
<dd><p>(read-only) The number of signal fit parameters the PDF ratio depends
on.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.signal_fitparam_names">
<em class="property">property </em><code class="sig-name descname">signal_fitparam_names</code><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.signal_fitparam_names" title="Permalink to this definition">¶</a></dt>
<dd><p>(read-only) The list of signal fit parameter names this PDF ratio is
a function of.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.pdf_type">
<em class="property">property </em><code class="sig-name descname">pdf_type</code><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.pdf_type" title="Permalink to this definition">¶</a></dt>
<dd><p>(read-only) The Python type of the PDF object for which the PDF
ratio is made for.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.get_ratio">
<em class="property">abstract </em><code class="sig-name descname">get_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tdm</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tl</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.get_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the PDF ratio value for each given trial data event, given
the given set of fit parameters. This method is called during the
likelihood maximization process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdm</strong> (<em>instance of TrialDataManager</em>) – The TrialDataManager instance holding the trial data events for
which the PDF ratio values should get calculated.</p></li>
<li><p><strong>params</strong> (<em>dict | None</em>) – The dictionary with the parameter name-value pairs.
It can be <code class="docutils literal notranslate"><span class="pre">None</span></code>, if the PDF ratio does not depend on any
parameters.</p></li>
<li><p><strong>tl</strong> (<em>TimeLord instance | None</em>) – The optional TimeLord instance that should be used to measure
timing information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ratios</strong> (<em>(N_events,)-shaped 1d numpy ndarray of float</em>) – The PDF ratio value for each trial event.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatio.get_gradient">
<em class="property">abstract </em><code class="sig-name descname">get_gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tdm</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">fitparam_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatio.get_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the PDF ratio gradient for the parameter <code class="docutils literal notranslate"><span class="pre">fitparam_name</span></code>
for each given trial event, given the given set of fit parameters.
This method is called during the likelihood maximization process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdm</strong> (<em>instance of TrialDataManager</em>) – The TrialDataManager instance holding the trial data events for
which the PDF ratio values should get calculated.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – The dictionary with the parameter names and values.</p></li>
<li><p><strong>fitparam_name</strong> (<em>str</em>) – The name of the fit parameter for which the gradient should
get calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gradient</strong> (<em>(N_events,)-shaped 1d numpy ndarray of float</em>) – The PDF ratio gradient value for each trial event.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">SingleSourcePDFRatioArrayArithmetic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdfratios</span></em>, <em class="sig-param"><span class="n">fitparams</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class provides arithmetic methods for arrays of PDFRatio instances.
It has methods to calculate the product of the ratio values for a given set
of PDFRatio objects. This class assumes a single source.</p>
<p>The rational is that in the calculation of the derivates of the
log-likelihood-ratio function for a given fit parameter, the product of the
PDF ratio values of the PDF ratio objects which do not depend on that fit
parameter is needed.</p>
<p>Constructs a PDFRatio array arithmetic object assuming a single
source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdfratios</strong> (<em>list of PDFRatio</em>) – The list of PDFRatio instances.</p></li>
<li><p><strong>fitparams</strong> (<em>list of FitParameter</em>) – The list of fit parameters. The order must match the fit parameter
order of the minimizer.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.pdfratio_list">
<em class="property">property </em><code class="sig-name descname">pdfratio_list</code><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.pdfratio_list" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of PDFRatio objects.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.fitparam_list">
<em class="property">property </em><code class="sig-name descname">fitparam_list</code><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.fitparam_list" title="Permalink to this definition">¶</a></dt>
<dd><p>The list of FitParameter instances.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.initialize_for_new_trial">
<code class="sig-name descname">initialize_for_new_trial</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tdm</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.initialize_for_new_trial" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the PDFRatio array arithmetic for a new trial. For a new
trial the data events change, hence we need to recompute the PDF ratio
values of the fit parameter independent PDFRatio instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tdm</strong> (<em>instance of TrialDataManager</em>) – The instance of TrialDataManager that holds the trial event data for
that this PDFRatioArrayArithmetic instance should get initialized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.get_pdfratio">
<code class="sig-name descname">get_pdfratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fitparam_idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.get_pdfratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the PDFRatio instance that corresponds to the given fit
parameter index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fitparam_idx</strong> (<em>int</em>) – The index of the fit parameter.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pdfratio</strong> (<em>PDFRatio</em>) – The PDFRatio instance which corresponds to the given fit parameter
index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.calculate_pdfratio_values">
<code class="sig-name descname">calculate_pdfratio_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tdm</span></em>, <em class="sig-param"><span class="n">fitparams</span></em>, <em class="sig-param"><span class="n">tl</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.calculate_pdfratio_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the PDF ratio values for the PDF ratio objects which
depend on fit parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdm</strong> (<em>instance of TrialDataManager</em>) – The instance of TrialDataManager that holds the trial event data for
which the PDF ratio values should get calculated.</p></li>
<li><p><strong>fitparams</strong> (<em>dict</em>) – The dictionary with the fit parameter name-value pairs.</p></li>
<li><p><strong>tl</strong> (<em>TimeLord instance | None</em>) – The optional TimeLord instance that should be used to measure
timing information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.get_ratio_product">
<code class="sig-name descname">get_ratio_product</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">excluded_fitparam_idx</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SingleSourcePDFRatioArrayArithmetic.get_ratio_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the product of the of the PDF ratio values of each event,
but excludes the PDF ratio values that correspond to the given excluded
fit parameter index. This is useful for calculating the derivates of
the log-likelihood ratio function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>excluded_fitparam_idx</strong> (<em>int | None</em>) – The index of the fit parameter whose PDF ratio values should get
excluded from the product. If None, the product over all PDF ratio
values will be computed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>product</strong> (<em>1D (N_events,)-shaped ndarray</em>) – The product of the PDF ratio values for each event.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.PDFRatioFillMethod">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">PDFRatioFillMethod</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatioFillMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract base class to implement a PDF ratio fill method. It can happen,
that there are empty background bins but where signal could possibly be.
A PDFRatioFillMethod implements what happens in such cases.</p>
<dl class="py method">
<dt id="skyllh.core.pdfratio.PDFRatioFillMethod.fill_ratios">
<em class="property">abstract </em><code class="sig-name descname">fill_ratios</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratios</span></em>, <em class="sig-param"><span class="n">sig_prob_h</span></em>, <em class="sig-param"><span class="n">bkg_prob_h</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered_zero_physics</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered_zero_physics</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.PDFRatioFillMethod.fill_ratios" title="Permalink to this definition">¶</a></dt>
<dd><p>The fill_ratios method is supposed to fill the ratio bins (array)
with the signal / background division values. For bins (array elements),
where the division is undefined, e.g. due to zero background, the fill
method decides how to fill those bins.</p>
<dl class="simple">
<dt>Note: Bins which have neither signal monte-carlo nor background</dt><dd><p>monte-carlo coverage, are undefined about their signal-ness or
background-ness by construction.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratios</strong> (<em>ndarray of float</em>) – The multi-dimensional array for the final ratio bins. The shape is
the same as the sig_h and bkg_h ndarrays.</p></li>
<li><p><strong>sig_prob_h</strong> (<em>ndarray of float</em>) – The multi-dimensional array (histogram) holding the signal
probabilities.</p></li>
<li><p><strong>bkg_prob_h</strong> (<em>ndarray of float</em>) – The multi-dimensional array (histogram) holding the background
probabilities.</p></li>
<li><p><strong>sig_mask_mc_covered</strong> (<em>ndarray of bool</em>) – The mask array indicating which array elements of sig_prob_h have
monte-carlo coverage.</p></li>
<li><p><strong>sig_mask_mc_covered_zero_physics</strong> (<em>ndarray of bool</em>) – The mask array indicating which array elements of sig_prob_h have
monte-carlo coverage but don’t have physics contribution.</p></li>
<li><p><strong>bkg_mask_mc_covered</strong> (<em>ndarray of bool</em>) – The mask array indicating which array elements of bkg_prob_h have
monte-carlo coverage.
In case of experimental data as background, this mask indicate where
(experimental data) background is available.</p></li>
<li><p><strong>bkg_mask_mc_covered_zero_physics</strong> (<em>ndarray of bool</em>) – The mask array ndicating which array elements of bkg_prob_h have
monte-carlo coverage but don’t have physics contribution.
In case of experimental data as background, this mask contains only
False entries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ratios</strong> (<em>ndarray</em>) – The array holding the final ratio values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.Skylab2SkylabPDFRatioFillMethod">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">Skylab2SkylabPDFRatioFillMethod</code><a class="headerlink" href="#skyllh.core.pdfratio.Skylab2SkylabPDFRatioFillMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#skyllh.core.pdfratio.PDFRatioFillMethod" title="skyllh.core.pdfratio.PDFRatioFillMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.pdfratio.PDFRatioFillMethod</span></code></a></p>
<p>This PDF ratio fill method implements the exact same fill method as in
the skylab2 software named “skylab”. It exists just for comparsion and
backward compatibility reasons. In general, it should not be used, because
it does not distinguish between bins with MC converage and physics model
contribution, and those with MC coverage and no physics model contribution!</p>
<dl class="py method">
<dt id="skyllh.core.pdfratio.Skylab2SkylabPDFRatioFillMethod.fill_ratios">
<code class="sig-name descname">fill_ratios</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratio</span></em>, <em class="sig-param"><span class="n">sig_prob_h</span></em>, <em class="sig-param"><span class="n">bkg_prob_h</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered_zero_physics</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered_zero_physics</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.Skylab2SkylabPDFRatioFillMethod.fill_ratios" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the ratio array.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.MostSignalLikePDFRatioFillMethod">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">MostSignalLikePDFRatioFillMethod</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">signallike_percentile</span><span class="o">=</span><span class="default_value">99.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.MostSignalLikePDFRatioFillMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#skyllh.core.pdfratio.PDFRatioFillMethod" title="skyllh.core.pdfratio.PDFRatioFillMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.pdfratio.PDFRatioFillMethod</span></code></a></p>
<p>PDF ratio fill method to set the PDF ratio to the most signal like PDF
ratio for bins, where there is signal MC coverage but no background (MC)
coverage.</p>
<p>Creates the PDF ratio fill method object for filling PDF ratio bins,
where there is signal MC coverage but no background (MC) coverage
with the most signal-like ratio value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>signallike_percentile</strong> (<em>float in range</em><em> [</em><em>0.</em><em>, </em><em>100.</em><em>]</em><em>, </em><em>default 99.</em>) – The percentile of signal-like ratios, which should be taken as the
ratio value for ratios with no background probability.</p>
</dd>
</dl>
<dl class="py method">
<dt id="skyllh.core.pdfratio.MostSignalLikePDFRatioFillMethod.signallike_percentile">
<em class="property">property </em><code class="sig-name descname">signallike_percentile</code><a class="headerlink" href="#skyllh.core.pdfratio.MostSignalLikePDFRatioFillMethod.signallike_percentile" title="Permalink to this definition">¶</a></dt>
<dd><p>The percentile of signal-like ratios, which should be taken as the
ratio value for ratios with no background probability. This percentile
must be given as a float value in the range [0, 100] inclusively.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.MostSignalLikePDFRatioFillMethod.fill_ratios">
<code class="sig-name descname">fill_ratios</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratio</span></em>, <em class="sig-param"><span class="n">sig_prob_h</span></em>, <em class="sig-param"><span class="n">bkg_prob_h</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered_zero_physics</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered_zero_physics</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.MostSignalLikePDFRatioFillMethod.fill_ratios" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the ratio array.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.MinBackgroundLikePDFRatioFillMethod">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">MinBackgroundLikePDFRatioFillMethod</code><a class="headerlink" href="#skyllh.core.pdfratio.MinBackgroundLikePDFRatioFillMethod" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#skyllh.core.pdfratio.PDFRatioFillMethod" title="skyllh.core.pdfratio.PDFRatioFillMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.pdfratio.PDFRatioFillMethod</span></code></a></p>
<p>PDF ratio fill method to set the PDF ratio to the minimal background like
value for bins, where there is signal MC coverage but no background (MC)
coverage.</p>
<p>Creates the PDF ratio fill method object for filling PDF ratio bins,
where there is signal MC coverage but no background (MC) coverage
with the minimal background-like ratio value.</p>
<dl class="py method">
<dt id="skyllh.core.pdfratio.MinBackgroundLikePDFRatioFillMethod.fill_ratios">
<code class="sig-name descname">fill_ratios</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratio</span></em>, <em class="sig-param"><span class="n">sig_prob_h</span></em>, <em class="sig-param"><span class="n">bkg_prob_h</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">sig_mask_mc_covered_zero_physics</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered</span></em>, <em class="sig-param"><span class="n">bkg_mask_mc_covered_zero_physics</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.MinBackgroundLikePDFRatioFillMethod.fill_ratios" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the ratio array.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.SigOverBkgPDFRatio">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">SigOverBkgPDFRatio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sig_pdf</span></em>, <em class="sig-param"><span class="n">bkg_pdf</span></em>, <em class="sig-param"><span class="n">pdf_type</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">same_axes</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">zero_bkg_ratio_value</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#skyllh.core.pdfratio.PDFRatio" title="skyllh.core.pdfratio.PDFRatio"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.pdfratio.PDFRatio</span></code></a></p>
<p>This class implements a generic signal-over-background PDF ratio for a
signal and a background PDF instance.
It takes a signal PDF of type <em>pdf_type</em> and a background PDF of type
<em>pdf_type</em> and calculates the PDF ratio.</p>
<p>Creates a new signal-over-background PDF ratio instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig_pdf</strong> (class instance derived from <cite>pdf_type</cite>, IsSignalPDF) – The instance of the signal PDF.</p></li>
<li><p><strong>bkg_pdf</strong> (class instance derived from <cite>pdf_type</cite>, IsBackgroundPDF) – The instance of the background PDF.</p></li>
<li><p><strong>pdf_type</strong> (<em>type | None</em>) – The python type of the PDF object for which the PDF ratio is for.
If set to None, the default class <code class="docutils literal notranslate"><span class="pre">PDF</span></code> will be used.</p></li>
<li><p><strong>same_axes</strong> (<em>bool</em>) – Flag if the signal and background PDFs are supposed to have the
same axes. Default is True.</p></li>
<li><p><strong>zero_bkg_ratio_value</strong> (<em>float</em>) – The value of the PDF ratio to take when the background PDF value
is zero. This is to avoid division by zero. Default is 1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="skyllh.core.pdfratio.SigOverBkgPDFRatio.sig_pdf">
<em class="property">property </em><code class="sig-name descname">sig_pdf</code><a class="headerlink" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio.sig_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>The signal PDF object used to create the PDF ratio.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigOverBkgPDFRatio.bkg_pdf">
<em class="property">property </em><code class="sig-name descname">bkg_pdf</code><a class="headerlink" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio.bkg_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>The background PDF object used to create the PDF ratio.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigOverBkgPDFRatio.zero_bkg_ratio_value">
<em class="property">property </em><code class="sig-name descname">zero_bkg_ratio_value</code><a class="headerlink" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio.zero_bkg_ratio_value" title="Permalink to this definition">¶</a></dt>
<dd><p>The value of the PDF ratio to take when the background PDF value
is zero. This is to avoid division by zero.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigOverBkgPDFRatio.get_ratio">
<code class="sig-name descname">get_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tdm</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tl</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio.get_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the PDF ratio for the given trial events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdm</strong> (<em>instance of TrialDataManager</em>) – The TrialDataManager instance holding the trial data events for
which the PDF ratio values should be calculated.</p></li>
<li><p><strong>params</strong> (<em>dict | None</em>) – The dictionary holding the parameter names and values for which the
probability ratio should get calculated.
This can be <code class="docutils literal notranslate"><span class="pre">None</span></code>, if the signal and background PDFs do not
depend on any parameters.</p></li>
<li><p><strong>tl</strong> (<em>TimeLord instance | None</em>) – The optional TimeLord instance that should be used to measure
timing information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ratios</strong> (<em>(N_events)-shaped numpy ndarray</em>) – The ndarray holding the probability ratio for each event (and each
source). The dimensionality of the returned ndarray depends on the
dimensionality of the probability ndarray returned by the
<code class="docutils literal notranslate"><span class="pre">get_prob</span></code> method of the signal PDF object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigOverBkgPDFRatio.get_gradient">
<code class="sig-name descname">get_gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tdm</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">fitparam_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio.get_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves the gradient of the PDF ratio w.r.t. the given fit
parameter. This method must be called after the <code class="docutils literal notranslate"><span class="pre">get_ratio</span></code> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tdm</strong> (<em>TrialDataManager instance</em>) – The instance of TrialDataManager that should be used to get the
trial data from.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – The dictionary with the parameter names and values.</p></li>
<li><p><strong>fitparam_name</strong> (<em>str</em>) – The name of the fit parameter for which the gradient should
get calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gradient</strong> (<em>(N_events,)-shaped 1d numpy ndarray of float</em>) – The PDF ratio gradient value for each trial event.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.SpatialSigOverBkgPDFRatio">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">SpatialSigOverBkgPDFRatio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sig_pdf</span></em>, <em class="sig-param"><span class="n">bkg_pdf</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SpatialSigOverBkgPDFRatio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#skyllh.core.pdfratio.SigOverBkgPDFRatio" title="skyllh.core.pdfratio.SigOverBkgPDFRatio"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.pdfratio.SigOverBkgPDFRatio</span></code></a></p>
<p>This class implements a signal-over-background PDF ratio for spatial
PDFs. It takes a signal PDF of type SpatialPDF and a background PDF of type
SpatialPDF and calculates the PDF ratio.</p>
<p>Creates a new signal-over-background PDF ratio instance for spatial
PDFs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig_pdf</strong> (<em>class instance derived from SpatialPDF</em><em>, </em><a class="reference internal" href="skyllh.core.pdf.html#skyllh.core.pdf.IsSignalPDF" title="skyllh.core.pdf.IsSignalPDF"><em>IsSignalPDF</em></a>) – The instance of the spatial signal PDF.</p></li>
<li><p><strong>bkg_pdf</strong> (<em>class instance derived from SpatialPDF</em><em>, </em><a class="reference internal" href="skyllh.core.pdf.html#skyllh.core.pdf.IsBackgroundPDF" title="skyllh.core.pdf.IsBackgroundPDF"><em>IsBackgroundPDF</em></a>) – The instance of the spatial background PDF.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="skyllh.core.pdfratio.SigSetOverBkgPDFRatio">
<em class="property">class </em><code class="sig-prename descclassname">skyllh.core.pdfratio.</code><code class="sig-name descname">SigSetOverBkgPDFRatio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdf_type</span></em>, <em class="sig-param"><span class="n">signalpdfset</span></em>, <em class="sig-param"><span class="n">backgroundpdf</span></em>, <em class="sig-param"><span class="n">interpolmethod</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SigSetOverBkgPDFRatio" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#skyllh.core.pdfratio.PDFRatio" title="skyllh.core.pdfratio.PDFRatio"><code class="xref py py-class docutils literal notranslate"><span class="pre">skyllh.core.pdfratio.PDFRatio</span></code></a></p>
<p>Class for a PDF ratio class that takes a PDFSet of PDF type
<em>pdf_type</em> as signal PDF and a PDF of type <em>pdf_type</em> as background PDF.
The signal PDF depends on signal fit parameters and a interpolation method
defines how the PDF ratio gets interpolated between the fit parameter
values.</p>
<p>Constructor called by creating an instance of a class which is
derived from this PDFRatio class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_type</strong> (<em>type</em>) – The Python type of the PDF object for which the PDF ratio is for.</p></li>
<li><p><strong>signalpdfset</strong> (<em>class instance derived from PDFSet</em><em> (</em><em>for PDF type</em>) – <code class="docutils literal notranslate"><span class="pre">pdf_type</span></code>), and IsSignalPDF
The PDF set, which provides signal PDFs for a set of
discrete signal fit parameters.</p></li>
<li><p><strong>backgroundpdf</strong> (class instance derived from <code class="docutils literal notranslate"><span class="pre">pdf_type</span></code>, and) – IsBackgroundPDF
The background PDF instance.</p></li>
<li><p><strong>interpolmethod</strong> (<em>class of GridManifoldInterpolationMethod | None</em>) – The class implementing the fit parameter interpolation method for
the PDF ratio manifold grid.
If set to None (default), the
Parabola1DGridManifoldInterpolationMethod will be used for
1-dimensional parameter manifolds.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="skyllh.core.pdfratio.SigSetOverBkgPDFRatio.backgroundpdf">
<em class="property">property </em><code class="sig-name descname">backgroundpdf</code><a class="headerlink" href="#skyllh.core.pdfratio.SigSetOverBkgPDFRatio.backgroundpdf" title="Permalink to this definition">¶</a></dt>
<dd><p>The background PDF object, derived from <code class="docutils literal notranslate"><span class="pre">pdf_type</span></code> and
IsBackgroundPDF.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigSetOverBkgPDFRatio.signalpdfset">
<em class="property">property </em><code class="sig-name descname">signalpdfset</code><a class="headerlink" href="#skyllh.core.pdfratio.SigSetOverBkgPDFRatio.signalpdfset" title="Permalink to this definition">¶</a></dt>
<dd><p>The signal PDFSet object for <code class="docutils literal notranslate"><span class="pre">pdf_type</span></code> PDF objects.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigSetOverBkgPDFRatio.interpolmethod">
<em class="property">property </em><code class="sig-name descname">interpolmethod</code><a class="headerlink" href="#skyllh.core.pdfratio.SigSetOverBkgPDFRatio.interpolmethod" title="Permalink to this definition">¶</a></dt>
<dd><p>The class derived from GridManifoldInterpolationMethod
implementing the interpolation of the fit parameter manifold.</p>
</dd></dl>

<dl class="py method">
<dt id="skyllh.core.pdfratio.SigSetOverBkgPDFRatio.convert_signal_fitparam_name_into_index">
<code class="sig-name descname">convert_signal_fitparam_name_into_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">signal_fitparam_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#skyllh.core.pdfratio.SigSetOverBkgPDFRatio.convert_signal_fitparam_name_into_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the given signal fit parameter name into the parameter
index, i.e. the position of parameter in the signal parameter grid set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>signal_fitparam_name</strong> (<em>str</em>) – The name of the signal fit parameter.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>index</strong> (<em>int</em>) – The index of the signal fit parameter.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="skyllh.core.progressbar.html" class="btn btn-neutral float-right" title="skyllh.core.progressbar module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="skyllh.core.pdf.html" class="btn btn-neutral float-left" title="skyllh.core.pdf module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, The IceCube Collaboration, T. Kontrimas, M. Wolf.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>